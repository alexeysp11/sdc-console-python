# sdc-console-python 
Данное приложение написано на языке Python и называется sdc-console-python, где sdc -- сокращение от Self Driving Car (беспилотный автомобиль).    
Оно выполнено в виде консольного приложения, которое позволяет моделировать отдельные модули системы датчиков беспилотного автомобиля при разных моделях поведения автомобиля (т.е. когда он стоит на месте, когда он движется с постоянной скоростью, или, например, когда он меняет угол своего движения).    
Это осуществляется посредством ввода необходимых команд через консоль. 
## Идея приложения 
Возможно, идея моделировать систему датчиков беспилотного автомобиля исключительно через консоль кому-то может показаться довольно необычным занятием.    
Но дело тут в следующем: я изначально задумывал написать приложение, которое позволило бы моделировать такую систему с помощью графического интерфейса. 
Однако мне пришлось столкнуться с полным отсутствием реализации модулей, которые отвечают за симуляцию датчиков и обработку данных с них. 
Вследствие этого было принято решение сначала реализовывать эти модули, после чего переходить к графической составляющей. Причем также планировалось объединить консоль и графический интерфейс в рамках одного приложения, запуская их из одного лаунчера.    
Самые первые модули были реализованы на Python, вследствие чего я продолжил дописывать и остальные модули на этом языке. Однако real-time система, написанная полностью на Python, будет довольно медленной (так было, по крайней мере, на моем компьютере). 
Поэтому консольная часть приложения на Python была выделена в отдельное приложение. А в настоящее время ведется работа над графической частью приложения, и переписываются модули на более низкоуровневый язык программирования.    
Таким образом, приложение `sdc-console-python` является лишь одним из промежуточных вариантов похожего приложения в виде графического интерфейса, который изначально задумывался. 
## Модули приложения
На данный момент я написал несколько модулей: 
- Фильтр Калмана и Real-Time Locating System, 
- Нечеткий регулятор, 
- Нейронная сеть для распознавания рукописных цифр.
### Фильтр Калмана и Real-Time Locating System
Фильтр Калмана позволяет уменьшить ошибку измерения и более точно оценить истинное значение измеряемого параметра на основе ранее измеренных значений.    
В первоначальном варианте, который я реализовал, фильтр Калмана выполнял абсолютно все: и генерировал эмпирические данные для GPS-приемника, и обрабатывал эти данные, и рисовал график зависмости измерений и рассчета, и выводил результаты расчета на консоль. 
Стоит отметить, что ФК ориентировался на неизменное местоположение автомобиля, а также дисперсия расчета (англ. process variance) представляла собой постоянный параметр.    
Позднее я разделил задачи, которые выполнял фильтр Калмана, между разными модулями и сделал так, чтобы параметр process variance с каждой итерацией менял свое значение в зависимости от рассчитанного значения ошибки на предыдущей итерации ("чем больше значение ошибки на предыдущей итерации, тем больший шаг мы должны сделать в текущей итерации, чтобы сократить эту ошибку").    
В совокупности эти решения позволили использовать фильтр Калмана для добавления моделей с постоянной скоростью и рандомным ускорением, а также для добавления гироскопа. 
### Нечеткий регулятор
Одной из идей того, как научить автомобиль самостоятельно рассчитывать скорость своего движения, может быть следующий алгоритм: 
1. Задать начальную и конечную точки движения автомобиля,
2. Оценить местоположение автомобиля в текущий момент времени и отметить его на карте, 
3. По карте рассчитать расстояние, которое автомобиль будет ехать по прямой без поворота, 
4. Поскольку практически любой водитель на повороте старается сбросить скорость, то имеет смысл научить тому же и автомобиль (т.е. научить автомобиль оперировать теми же понятиями, что и человек).    
Скопировать модель мышления человека можно с помощью построения регулятора нечеткой логики (или нечеткого регулятора).    
В общем смысле нечеткий регулятор позволяет автомобилю регулировать свою скорость согласно идее о том, что если точка поворота далеко, то можно ехать с приличной скоростью, а если она близко, то скорость следует сбавить. 
Это можно сделать следующим образом:
1. Определить границы таких понятий как "близко", "далеко", "низкая скорость" и "высокая скорость" в числовых значениях, 
2. Соотнести понятию "близко" понятие "низкая скорость" и понятию "далеко" -- понятие "высокая скорость" в виде импликации "если, то", 
3. Применить алгоритм нечеткого вывода (наиболее используемым является алгоритм Мамдани).    
Таким образом, задача нечеткого регулятора заключается в том, чтобы взять расстояние до следующей точки поворота и вернуть скорость, соответствующую этому расстоянию. 
### Нейронная сеть для распознавания рукописных цифр
Огромное количество информации, необходимой для движения автомобиля является визуальной (например, дорожная разметка, дорожные знаки и сигналы светофора). 
Причем такого рода информацию невозможно получить с помощью т.н. традиционных методов измерения с помощью радара, лидара, GPS, гироскопа и акселерометра. Хорошо зарекомендовавшим себя решением для компьютерного зрения в настоящее время являются нейронные сети.    
Однако построение нейронных сетей (особенно если речь идет о real-time системах) является нетривиальной задачей, требующей достаточно большого объема знаний и навыков.    
Моих знаний и моего времени пока хватило лишь на то, чтобы найти в Интернете алгоритм нейросети для распознавания рукописных цифр MNIST, который сможет запуститься на моем старом и медленном компьютере. Как я понял, такая нейросеть является своего рода Hello World в области компьютерного зрения. 
## Система команд 
Теперь я вкратце расскажу о принятой в данном приложении системе команд. 
Команды вводятся в следующем виде:    
```название_приложения название_модуля --режим_работы```   
Например, если необходимо промоделировать модуль GPS при условии, что автомобиль движется с постоянной скоростью, то нужно ввести `sdc gps --v`. 
Если надо промоделировать работу гироскопа при условии, что угол, под которым движется автомобиль, неизменен, то следует ввести `sdc gyro --const` и т.д.    
Дополнительную информацию по командам можно найти при запуске программы, введя команду `sdc` или `sdc -commands`.    
Служебные модули вызываются следующим образом:    
```название_приложения -служебный_модуль```    
Например, `sdc -commands` или `sdc -help`.